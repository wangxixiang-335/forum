import{d as V,r as h,c as y,i as w,a as l,b as s,n as d,t,u as I,g as S,F as j,h as z,x as k,y as A,s as M,o as c,_ as U}from"./index-02sh5J2l.js";const B={class:"connection-test"},R={class:"container"},X={class:"config-info"},x={class:"config-item"},D={class:"config-item"},L={class:"test-section"},O=["disabled"],F={key:0,class:"details"},T={class:"database-status"},Z={key:0,class:"tables"},K={class:"table-icon"},Y={class:"table-name"},q={class:"table-status"},G={key:1},$=V({__name:"ConnectionTestView",setup(P){const C=M(),i=h(!1),a=h(null),u=h([]),r="https://bkintupjzbcjiqvzricz.supabase.co",f="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJraW50dXBqemJjamlxdnpyaWN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE2MDYzNDEsImV4cCI6MjA3NzE4MjM0MX0.ZA6l95LSZ_x2DFfJGCcXMXLlRg9nOV7kNqEJUC7OG8o",p=y(()=>!r.includes("default.supabase.co")),g=y(()=>!f.includes("default")),E=async()=>{i.value=!0,a.value=null,u.value=[];try{console.log("🔗 开始测试Supabase连接...");const{data:n,error:e}=await k.auth.getSession();if(e)throw e;const o=["profiles","posts","comments","interactions"],b=[];for(const m of o)try{const{data:v,error:_}=await k.from(m).select("count").limit(1);b.push({name:m,accessible:!_,error:_?_.message:null})}catch(v){b.push({name:m,accessible:!1,error:v instanceof Error?v.message:"未知错误"})}u.value=b,a.value={success:!0,message:"Supabase连接成功！所有配置正确。",details:`认证状态: ${n.session?"已登录":"未登录"}
表访问测试完成`},console.log("✅ Supabase连接测试成功")}catch(n){const e=A(n);a.value={success:!1,message:e.message,details:`错误代码: ${e.code}
建议检查环境变量配置`},console.error("❌ Supabase连接测试失败:",n)}finally{i.value=!1}},J=()=>{C.push("/")},N=()=>{if(p.value){const n=r.split(".")[0].replace("https://","");window.open(`https://supabase.com/dashboard/project/${n}`,"_blank")}else window.open("https://supabase.com/dashboard","_blank")};return w(()=>{console.log("🔗 连接测试页面已加载"),console.log("环境变量检查:"),console.log("VITE_SUPABASE_URL:",r),console.log("VITE_SUPABASE_ANON_KEY:","已配置")}),(n,e)=>(c(),l("div",B,[s("div",R,[e[4]||(e[4]=s("h1",null,"🔗 Supabase连接测试",-1)),s("div",X,[e[2]||(e[2]=s("h2",null,"当前配置",-1)),s("div",x,[e[0]||(e[0]=s("strong",null,"Supabase URL:",-1)),s("span",{class:d({valid:p.value,invalid:!p.value})},t(I(r)||"未配置"),3)]),s("div",D,[e[1]||(e[1]=s("strong",null,"Anon Key:",-1)),s("span",{class:d({valid:g.value,invalid:!g.value})},t(I(f)?"已配置":"未配置"),3)])]),s("div",L,[s("button",{onClick:E,disabled:i.value,class:"test-btn"},t(i.value?"测试中...":"测试连接"),9,O),a.value?(c(),l("div",{key:0,class:d(["result",a.value.success?"success":"error"])},[s("h3",null,t(a.value.success?"✅ 连接成功":"❌ 连接失败"),1),s("p",null,t(a.value.message),1),a.value.details?(c(),l("div",F,[s("pre",null,t(a.value.details),1)])):S("",!0)],2)):S("",!0)]),s("div",T,[e[3]||(e[3]=s("h2",null,"数据库表状态",-1)),u.value?(c(),l("div",Z,[(c(!0),l(j,null,z(u.value,o=>(c(),l("div",{key:o.name,class:d(["table-item",{accessible:o.accessible,inaccessible:!o.accessible}])},[s("span",K,t(o.accessible?"✅":"❌"),1),s("span",Y,t(o.name),1),s("span",q,t(o.accessible?"可访问":"不可访问"),1)],2))),128))])):(c(),l("p",G,"点击测试连接查看表状态"))]),s("div",{class:"actions"},[s("button",{onClick:J,class:"action-btn primary"},"前往首页"),s("button",{onClick:N,class:"action-btn secondary"},"打开Supabase控制台")])])]))}}),H=U($,[["__scopeId","data-v-7ce5ad4c"]]);export{H as default};
//# sourceMappingURL=ConnectionTestView-Xu0I8-ch.js.map
