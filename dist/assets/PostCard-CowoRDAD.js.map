{"version":3,"file":"PostCard-CowoRDAD.js","sources":["../../src/components/PostCard.vue"],"sourcesContent":["<template>\r\n  <article class=\"post-card\" :class=\"{ 'post-pinned': post.is_pinned }\">\r\n    <div class=\"post-header\">\r\n      <div class=\"user-info\">\r\n        <img \r\n          :src=\"post.profiles.avatar_url || '/default-avatar.png'\" \r\n          :alt=\"post.profiles.username\"\r\n          class=\"avatar\"\r\n        />\r\n        <div class=\"user-details\">\r\n          <span class=\"username\" :class=\"getLevelClass(post.profiles.level)\">\r\n            {{ post.profiles.username }}\r\n            <span class=\"level-badge\">Lv.{{ post.profiles.level }}</span>\r\n          </span>\r\n          <span class=\"post-time\">{{ formatTime(post.created_at) }}</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"post-actions\">\r\n        <div v-if=\"post.is_pinned\" class=\"pinned-indicator\">\r\n          <span>üìå ÁΩÆÈ°∂</span>\r\n        </div>\r\n        <button \r\n          v-if=\"isAuthor\" \r\n          class=\"delete-btn\" \r\n          @click=\"handleDeletePost\"\r\n          title=\"Âà†Èô§Â∏ñÂ≠ê\"\r\n        >\r\n          üóëÔ∏è\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"post-content\">\r\n      <h3 class=\"post-title\">\r\n        <RouterLink :to=\"`/post/${post.id}`\" class=\"title-link\">\r\n          {{ post.title }}\r\n        </RouterLink>\r\n      </h3>\r\n      <p class=\"post-excerpt\">{{ getExcerpt(post.content) }}</p>\r\n      \r\n      <div v-if=\"post.tags && post.tags.length > 0\" class=\"post-tags\">\r\n        <span \r\n          v-for=\"tag in post.tags.slice(0, 3)\" \r\n          :key=\"tag\" \r\n          class=\"tag\"\r\n        >\r\n          #{{ tag }}\r\n        </span>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"post-footer\">\r\n      <div class=\"interaction-stats\">\r\n        <button \r\n          class=\"interaction-btn\" \r\n          :class=\"{ active: post.user_has_liked }\"\r\n          @click=\"$emit('like', post.id)\"\r\n        >\r\n          üëç {{ post.like_count }}\r\n        </button>\r\n        <button class=\"interaction-btn\" @click=\"$emit('comment', post.id)\">\r\n          üí¨ {{ post.comment_count }}\r\n        </button>\r\n        <span class=\"view-count\">üëÅÔ∏è {{ post.view_count }}</span>\r\n      </div>\r\n    </div>\r\n  </article>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed } from 'vue'\r\nimport { useAuthStore } from '@/stores/auth'\r\nimport { usePostStore } from '@/stores/posts'\r\nimport type { Database } from '@/types/supabase'\r\n\r\ninterface Props {\r\n  post: Database['public']['Tables']['posts']['Row'] & {\r\n    profiles: {\r\n      username: string\r\n      avatar_url: string | null\r\n      level: number\r\n    }\r\n    user_has_liked?: boolean\r\n  }\r\n}\r\n\r\nconst props = defineProps<Props>()\r\n\r\nconst authStore = useAuthStore()\r\nconst postStore = usePostStore()\r\n\r\ndefineEmits<{\r\n  like: [postId: string]\r\n  comment: [postId: string]\r\n}>()\r\n\r\n// Ê£ÄÊü•ÊòØÂê¶‰∏∫Â∏ñÂ≠ê‰ΩúËÄÖ\r\nconst isAuthor = computed(() => {\r\n  return authStore.user?.id === props.post.user_id\r\n})\r\n\r\n// Âà†Èô§Â∏ñÂ≠ê\r\nconst handleDeletePost = async () => {\r\n  if (!confirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Â∏ñÂ≠êÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§ç„ÄÇ')) {\r\n    return\r\n  }\r\n  \r\n  const result = await postStore.deletePost(props.post.id)\r\n  if (result.success) {\r\n    console.log('Â∏ñÂ≠êÂà†Èô§ÊàêÂäü')\r\n  } else {\r\n    console.error('Âà†Èô§Â∏ñÂ≠êÂ§±Ë¥•:', result.error)\r\n    alert('Âà†Èô§Â§±Ë¥•: ' + result.error)\r\n  }\r\n}\r\n\r\n// Ê†πÊçÆÁî®Êà∑Á≠âÁ∫ßËé∑ÂèñÊ†∑ÂºèÁ±ª\r\nconst getLevelClass = (level: number) => {\r\n  if (level >= 10) return 'level-10-plus'\r\n  if (level >= 7) return 'level-7-9'\r\n  if (level >= 4) return 'level-4-6'\r\n  return 'level-1-3'\r\n}\r\n\r\n// Ê†ºÂºèÂåñÊó∂Èó¥ÊòæÁ§∫\r\nconst formatTime = (timestamp: string) => {\r\n  const date = new Date(timestamp)\r\n  const now = new Date()\r\n  const diff = now.getTime() - date.getTime()\r\n  \r\n  if (diff < 60000) return 'ÂàöÂàö'\r\n  if (diff < 3600000) return `${Math.floor(diff / 60000)}ÂàÜÈíüÂâç`\r\n  if (diff < 86400000) return `${Math.floor(diff / 3600000)}Â∞èÊó∂Ââç`\r\n  if (diff < 604800000) return `${Math.floor(diff / 86400000)}Â§©Ââç`\r\n  \r\n  return date.toLocaleDateString('zh-CN')\r\n}\r\n\r\n// Ëé∑ÂèñÂÜÖÂÆπÊëòË¶Å\r\nconst getExcerpt = (content: string) => {\r\n  const plainText = content.replace(/[#*_~`]/g, '').replace(/\\n/g, ' ')\r\n  return plainText.length > 100 ? plainText.substring(0, 100) + '...' : plainText\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.post-card {\r\n  background: white;\r\n  border-radius: 8px;\r\n  padding: 1.5rem;\r\n  margin-bottom: 1rem;\r\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\r\n  transition: box-shadow 0.2s;\r\n}\r\n\r\n.post-card:hover {\r\n  box-shadow: 0 2px 8px rgba(0,0,0,0.15);\r\n}\r\n\r\n.post-pinned {\r\n  border-left: 4px solid #ff6b35;\r\n}\r\n\r\n.post-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: flex-start;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.post-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.delete-btn {\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-size: 1.2rem;\r\n  padding: 0.25rem;\r\n  border-radius: 4px;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.delete-btn:hover {\r\n  background: #fff1f0;\r\n  color: #ff4d4f;\r\n}\r\n\r\n.user-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.75rem;\r\n}\r\n\r\n.avatar {\r\n  width: 40px;\r\n  height: 40px;\r\n  border-radius: 50%;\r\n  object-fit: cover;\r\n}\r\n\r\n.user-details {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.25rem;\r\n}\r\n\r\n.username {\r\n  font-weight: 600;\r\n  font-size: 1rem;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.level-badge {\r\n  background: #e8f4fd;\r\n  color: #1890ff;\r\n  padding: 0.125rem 0.5rem;\r\n  border-radius: 12px;\r\n  font-size: 0.75rem;\r\n  font-weight: 500;\r\n}\r\n\r\n.level-4-6 {\r\n  color: #52c41a;\r\n}\r\n\r\n.level-7-9 {\r\n  color: #fa8c16;\r\n}\r\n\r\n.level-10-plus {\r\n  color: #f5222d;\r\n  font-weight: 700;\r\n}\r\n\r\n.post-time {\r\n  font-size: 0.875rem;\r\n  color: #666;\r\n}\r\n\r\n.pinned-indicator {\r\n  background: #fff7e6;\r\n  color: #fa8c16;\r\n  padding: 0.25rem 0.5rem;\r\n  border-radius: 4px;\r\n  font-size: 0.875rem;\r\n}\r\n\r\n.post-content {\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.post-title {\r\n  margin: 0 0 0.5rem 0;\r\n  font-size: 1.25rem;\r\n  line-height: 1.4;\r\n}\r\n\r\n.title-link {\r\n  color: #1890ff;\r\n  text-decoration: none;\r\n}\r\n\r\n.title-link:hover {\r\n  color: #40a9ff;\r\n  text-decoration: underline;\r\n}\r\n\r\n.post-excerpt {\r\n  color: #666;\r\n  line-height: 1.6;\r\n  margin-bottom: 0.75rem;\r\n}\r\n\r\n.post-tags {\r\n  display: flex;\r\n  gap: 0.5rem;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.tag {\r\n  background: #f0f2f5;\r\n  color: #666;\r\n  padding: 0.25rem 0.5rem;\r\n  border-radius: 4px;\r\n  font-size: 0.875rem;\r\n}\r\n\r\n.post-footer {\r\n  border-top: 1px solid #f0f0f0;\r\n  padding-top: 1rem;\r\n}\r\n\r\n.interaction-stats {\r\n  display: flex;\r\n  gap: 1rem;\r\n  align-items: center;\r\n}\r\n\r\n.interaction-btn {\r\n  background: none;\r\n  border: 1px solid #d9d9d9;\r\n  padding: 0.5rem 1rem;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  color: #666;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.interaction-btn:hover {\r\n  border-color: #1890ff;\r\n  color: #1890ff;\r\n}\r\n\r\n.interaction-btn.active {\r\n  background: #1890ff;\r\n  color: white;\r\n  border-color: #1890ff;\r\n}\r\n\r\n.view-count {\r\n  color: #999;\r\n  font-size: 0.875rem;\r\n}\r\n</style>"],"names":["props","__props","authStore","useAuthStore","postStore","usePostStore","isAuthor","computed","_a","handleDeletePost","result","getLevelClass","level","formatTime","timestamp","date","diff","getExcerpt","content","plainText","_createElementBlock","_normalizeClass","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_4","_createTextVNode","_toDisplayString","_hoisted_5","_hoisted_6","_hoisted_7","_openBlock","_hoisted_8","_cache","_hoisted_9","_hoisted_10","_createVNode","_component_RouterLink","_hoisted_11","_hoisted_12","_Fragment","tag","_hoisted_13","_hoisted_14","$event","$emit","_hoisted_15"],"mappings":"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"}