{"version":3,"mappings":"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","names":["emit","__emit","selectedAvatar","ref","currentAvatar","avatars","onMounted","saved","selectAvatar","avatar","saveAvatar","a","nextTick","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_cache","$emit","_hoisted_3","_Fragment","_renderList","$event","_normalizeStyle","_hoisted_5","_toDisplayString","_hoisted_6","_hoisted_7","_hoisted_8","route","useRoute","authStore","useAuthStore","postStore","usePostStore","isViewingOtherUser","computed","targetUserId","loading","userPosts","showAvatarSelector","profile","otherUserProfile","getLevelExpRequired","level","expTable","baseExp","extraLevels","nextLevelExp","currentLevelExp","expProgress","currentExp","currentLevelReq","nextLevelReq","expNeededForNext","totalExpForProgress","progress","getLevelName","levelNames","canChangeAvatar","_a","currentPrivileges","privileges","loadUserData","loadOtherUserData","profileError","loadUserPosts","error","result","handleLike","postId","handleComment","handleAvatarSelect","supabaseUrl","supabaseKey","supabase","__vitePreload","n","previousAvatar","profileData","postsData","postsError","getLevelClass","debugExperience","addTestExperience","formatDate","timestamp","_hoisted_4","_createVNode","_component_RouterLink","_hoisted_9","_hoisted_10","_hoisted_11","UserAvatar","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","privilege","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","post","_createBlock","PostCard","_hoisted_27","_hoisted_28","_hoisted_29","AvatarSelector"],"ignoreList":[],"sources":["../../src/components/AvatarSelector.vue","../../src/views/ProfileView.vue"],"sourcesContent":["<template>\r\n  <div class=\"avatar-selector\">\r\n    <div class=\"selector-header\">\r\n      <h3>选择头像</h3>\r\n      <button @click=\"$emit('close')\" class=\"close-btn\" title=\"关闭\">\r\n        ✕\r\n      </button>\r\n    </div>\r\n    <div class=\"avatar-grid\">\r\n      <div \r\n        v-for=\"avatar in avatars\" \r\n        :key=\"avatar.id\"\r\n        class=\"avatar-option\"\r\n        :class=\"{ active: selectedAvatar === avatar.id }\"\r\n        @click=\"selectAvatar(avatar)\"\r\n      >\r\n        <div class=\"avatar-preview\" :style=\"{ backgroundColor: avatar.color }\">\r\n          <span class=\"avatar-icon\">{{ avatar.icon }}</span>\r\n        </div>\r\n        <span class=\"avatar-name\">{{ avatar.name }}</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"avatar-actions\">\r\n      <button @click=\"saveAvatar\" class=\"btn-primary\" :disabled=\"!selectedAvatar\">\r\n        保存头像\r\n      </button>\r\n      <button @click=\"$emit('close')\" class=\"btn-secondary\">\r\n        取消\r\n      </button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted, nextTick } from 'vue'\r\n\r\ninterface Avatar {\r\n  id: string\r\n  name: string\r\n  icon: string\r\n  color: string\r\n}\r\n\r\nconst emit = defineEmits<{\r\n  close: []\r\n  select: [avatar: Avatar]\r\n}>()\r\n\r\nconst selectedAvatar = ref<string>('')\r\nconst currentAvatar = ref<string>('')\r\n\r\nconst avatars: Avatar[] = [\r\n  { id: 'cat', name: '猫咪', icon: '🐱', color: '#FF6B6B' },\r\n  { id: 'dog', name: '小狗', icon: '🐶', color: '#4ECDC4' },\r\n  { id: 'bear', name: '小熊', icon: '🐻', color: '#45B7D1' },\r\n  { id: 'rabbit', name: '兔子', icon: '🐰', color: '#96CEB4' },\r\n  { id: 'panda', name: '熊猫', icon: '🐼', color: '#FFEAA7' },\r\n  { id: 'fox', name: '狐狸', icon: '🦊', color: '#DDA0DD' },\r\n  { id: 'lion', name: '狮子', icon: '🦁', color: '#FFA07A' },\r\n  { id: 'monkey', name: '猴子', icon: '🐵', color: '#98D8C8' },\r\n  { id: 'pig', name: '小猪', icon: '🐷', color: '#FFB6C1' },\r\n  { id: 'cow', name: '奶牛', icon: '🐮', color: '#87CEEB' },\r\n  { id: 'tiger', name: '老虎', icon: '🐯', color: '#FFD700' },\r\n  { id: 'elephant', name: '大象', icon: '🐘', color: '#F0E68C' },\r\n  { id: 'giraffe', name: '长颈鹿', icon: '🦒', color: '#FFA500' },\r\n  { id: 'penguin', name: '企鹅', icon: '🐧', color: '#B0E0E6' },\r\n  { id: 'owl', name: '猫头鹰', icon: '🦉', color: '#D8BFD8' },\r\n  { id: 'turtle', name: '乌龟', icon: '🐢', color: '#90EE90' }\r\n]\r\n\r\nonMounted(() => {\r\n  // 从本地存储获取当前头像\r\n  const saved = localStorage.getItem('userAvatar')\r\n  if (saved) {\r\n    selectedAvatar.value = saved\r\n    currentAvatar.value = saved\r\n  }\r\n})\r\n\r\nconst selectAvatar = (avatar: Avatar) => {\r\n  selectedAvatar.value = avatar.id\r\n}\r\n\r\nconst saveAvatar = () => {\r\n  if (!selectedAvatar.value) return\r\n  \r\n  const avatar = avatars.find(a => a.id === selectedAvatar.value)\r\n  if (avatar) {\r\n    emit('select', avatar)\r\n    // 使用nextTick确保在DOM更新后再发出close事件\r\n    nextTick(() => {\r\n      emit('close')\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.avatar-selector {\r\n  background: white;\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\r\n  max-width: 600px;\r\n  max-height: 80vh;\r\n  overflow-y: auto;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.selector-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 1.5rem 2rem 1rem;\r\n  border-bottom: 1px solid #f0f0f0;\r\n}\r\n\r\n.avatar-selector h3 {\r\n  margin: 0;\r\n  color: #333;\r\n  font-size: 1.5rem;\r\n}\r\n\r\n.close-btn {\r\n  background: none;\r\n  border: none;\r\n  font-size: 1.5rem;\r\n  color: #999;\r\n  cursor: pointer;\r\n  padding: 0.5rem;\r\n  border-radius: 50%;\r\n  width: 32px;\r\n  height: 32px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.close-btn:hover {\r\n  background: #f5f5f5;\r\n  color: #666;\r\n}\r\n\r\n.avatar-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));\r\n  gap: 1rem;\r\n  padding: 1.5rem 2rem;\r\n  flex: 1;\r\n  overflow-y: auto;\r\n}\r\n\r\n.avatar-option {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 1rem;\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease;\r\n  border: 2px solid transparent;\r\n}\r\n\r\n.avatar-option:hover {\r\n  background: #f8f9fa;\r\n  transform: translateY(-2px);\r\n}\r\n\r\n.avatar-option.active {\r\n  border-color: #1890ff;\r\n  background: #e6f7ff;\r\n}\r\n\r\n.avatar-preview {\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin-bottom: 0.5rem;\r\n  font-size: 2rem;\r\n  border: 3px solid #fff;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.avatar-name {\r\n  font-size: 0.875rem;\r\n  color: #666;\r\n  text-align: center;\r\n}\r\n\r\n.avatar-actions {\r\n  display: flex;\r\n  gap: 1rem;\r\n  justify-content: center;\r\n  padding: 1rem 2rem 1.5rem;\r\n  border-top: 1px solid #f0f0f0;\r\n  background: #fafafa;\r\n}\r\n\r\n.btn-primary, .btn-secondary {\r\n  padding: 0.75rem 2rem;\r\n  border: none;\r\n  border-radius: 6px;\r\n  font-size: 1rem;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease;\r\n  min-width: 120px;\r\n}\r\n\r\n.btn-primary {\r\n  background: #1890ff;\r\n  color: white;\r\n}\r\n\r\n.btn-primary:hover:not(:disabled) {\r\n  background: #40a9ff;\r\n}\r\n\r\n.btn-primary:disabled {\r\n  background: #ccc;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.btn-secondary {\r\n  background: #f5f5f5;\r\n  color: #666;\r\n}\r\n\r\n.btn-secondary:hover {\r\n  background: #e8e8e8;\r\n}\r\n</style>","<template>\r\n  <div class=\"profile\">\r\n    <header class=\"header\">\r\n      <div class=\"container\">\r\n        <div class=\"header-nav\">\r\n          <RouterLink to=\"/\" class=\"back-link\">← 返回首页</RouterLink>\r\n          <nav class=\"nav\" v-if=\"!isViewingOtherUser\">\r\n            <RouterLink to=\"/profile\" class=\"nav-link active\">个人中心</RouterLink>\r\n            <RouterLink to=\"/bookmarks\" class=\"nav-link\">\r\n              <i class=\"bi bi-bookmark\"></i>\r\n              收藏\r\n            </RouterLink>\r\n            <RouterLink to=\"/messages\" class=\"nav-link\">\r\n              <i class=\"bi bi-envelope\"></i>\r\n              消息\r\n            </RouterLink>\r\n          </nav>\r\n        </div>\r\n        <h1>{{ isViewingOtherUser ? '用户资料' : '个人中心' }}</h1>\r\n      </div>\r\n    </header>\r\n\r\n    <main class=\"main\">\r\n      <div class=\"container\">\r\n        <div v-if=\"loading\" class=\"loading\">加载中...</div>\r\n        \r\n        <div v-else-if=\"profile\" class=\"profile-content\">\r\n          <!-- 用户信息卡片 -->\r\n          <div class=\"profile-card\">\r\n            <div class=\"profile-header\">\r\n              <div class=\"avatar-container\" @click=\"!isViewingOtherUser && canChangeAvatar && (showAvatarSelector = true)\">\r\n                <UserAvatar \r\n                  :username=\"profile.username\" \r\n                  :avatar-id=\"profile.avatar_url\"\r\n                  size=\"80px\"\r\n                />\r\n                <div class=\"avatar-edit-hint\" v-if=\"!isViewingOtherUser && canChangeAvatar\">\r\n                  <span>点击更换</span>\r\n                </div>\r\n                <div class=\"avatar-locked\" v-else-if=\"!isViewingOtherUser\">\r\n                  <span>Lv.3 解锁</span>\r\n                </div>\r\n              </div>\r\n              <div class=\"profile-info\">\r\n                <h2 class=\"username\" :class=\"getLevelClass(profile.level)\">\r\n                  {{ profile.username }}\r\n                  <span class=\"level-badge\">Lv.{{ profile.level }} {{ getLevelName(profile.level) }}</span>\r\n                </h2>\r\n                <p class=\"member-since\">\r\n                  注册时间：{{ formatDate(profile.created_at) }}\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- 经验值进度条 -->\r\n            <div class=\"experience-section\">\r\n              <div class=\"exp-info\">\r\n                <span>经验值：{{ profile.experience_points || 0 }}</span>\r\n                <span>下一等级：{{ (nextLevelExp - (profile.experience_points || 0)) > 0 ? (nextLevelExp - (profile.experience_points || 0)) + ' EXP' : '已满' }}</span>\r\n                <button @click=\"debugExperience\" class=\"debug-btn\" title=\"调试经验值\">\r\n                  调试\r\n                </button>\r\n              </div>\r\n              <div class=\"exp-progress\">\r\n                <div \r\n                  class=\"exp-bar\" \r\n                  :style=\"{ width: expProgress + '%' }\"\r\n                ></div>\r\n                <span class=\"exp-text\">{{ expProgress }}%</span>\r\n              </div>\r\n              <div class=\"exp-debug\">\r\n                <button @click=\"addTestExperience\" class=\"test-btn\">\r\n                  测试+10经验\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- 用户特权 -->\r\n            <div class=\"privileges-section\">\r\n              <h3>当前特权</h3>\r\n              <div class=\"privileges-list\">\r\n                <div \r\n                  v-for=\"privilege in currentPrivileges\" \r\n                  :key=\"privilege.id\"\r\n                  class=\"privilege-item\"\r\n                >\r\n                  <span class=\"privilege-icon\">{{ privilege.icon }}</span>\r\n                  <span class=\"privilege-name\">{{ privilege.name }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- 用户帖子 -->\r\n          <div class=\"user-posts\">\r\n            <h3>我的帖子</h3>\r\n            <div v-if=\"userPosts.length > 0\" class=\"posts-list\">\r\n              <PostCard \r\n                v-for=\"post in userPosts\" \r\n                :key=\"post.id\" \r\n                :post=\"post\"\r\n                @like=\"handleLike\"\r\n                @comment=\"handleComment\"\r\n              />\r\n            </div>\r\n            <div v-else class=\"no-posts\">\r\n              <p>还没有发布过帖子</p>\r\n              <RouterLink to=\"/\" class=\"btn-primary\">去发布第一个帖子</RouterLink>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div v-else class=\"error\">\r\n          <p>用户信息加载失败</p>\r\n        </div>\r\n      </div>\r\n    </main>\r\n\r\n    <!-- 头像选择器模态框 -->\r\n    <div v-if=\"showAvatarSelector\" class=\"modal-overlay\" @click.self=\"showAvatarSelector = false\">\r\n      <div class=\"modal-content\">\r\n        <AvatarSelector \r\n          @close=\"showAvatarSelector = false\"\r\n          @select=\"handleAvatarSelect\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport { useRoute } from 'vue-router'\r\nimport { useAuthStore } from '@/stores/auth'\r\nimport { usePostStore } from '@/stores/posts'\r\nimport PostCard from '@/components/PostCard.vue'\r\nimport UserAvatar from '@/components/UserAvatar.vue'\r\nimport AvatarSelector from '@/components/AvatarSelector.vue'\r\nimport type { Database } from '@/types/supabase'\r\n\r\nconst route = useRoute()\r\nconst authStore = useAuthStore()\r\nconst postStore = usePostStore()\r\n\r\n// 检查是否是查看其他用户的资料\r\nconst isViewingOtherUser = computed(() => !!route.params.id)\r\nconst targetUserId = computed(() => route.params.id as string)\r\n\r\nconst loading = ref(true)\r\nconst userPosts = ref<Database['public']['Tables']['posts']['Row'][]>([])\r\nconst showAvatarSelector = ref(false)\r\n\r\nconst profile = computed(() => {\r\n  if (isViewingOtherUser.value) {\r\n    return otherUserProfile.value\r\n  }\r\n  return authStore.profile\r\n})\r\n\r\nconst otherUserProfile = ref<any>(null)\r\n\r\n// 论坛等级经验表\r\nconst getLevelExpRequired = (level: number) => {\r\n  const expTable = [\r\n    0,    // Lv.1\r\n    50,   // Lv.2 - 新手\r\n    150,  // Lv.3 - 初级\r\n    300,  // Lv.4 - 中级\r\n    500,  // Lv.5 - 高级\r\n    800,  // Lv.6 - 资深\r\n    1200, // Lv.7 - 专家\r\n    1800, // Lv.8 - 大师\r\n    2500, // Lv.9 - 宗师\r\n    3500, // Lv.10 - 传奇\r\n    5000, // Lv.11 - 史诗\r\n    7000, // Lv.12 - 神话\r\n    10000 // Lv.13 - 至尊\r\n  ]\r\n  \r\n  if (level <= 1) return 0\r\n  if (level >= expTable.length) {\r\n    // 超过表格范围，使用递增公式\r\n    const baseExp = expTable[expTable.length - 1]\r\n    const extraLevels = level - expTable.length + 1\r\n    return baseExp + extraLevels * 2000\r\n  }\r\n  \r\n  return expTable[level - 1]\r\n}\r\n\r\n// 计算下一等级所需经验值\r\nconst nextLevelExp = computed(() => {\r\n  if (!profile.value) return 50\r\n  const level = profile.value.level\r\n  return getLevelExpRequired(level + 1)\r\n})\r\n\r\n// 计算当前等级所需经验值\r\nconst currentLevelExp = computed(() => {\r\n  if (!profile.value) return 0\r\n  const level = profile.value.level\r\n  return getLevelExpRequired(level)\r\n})\r\n\r\n// 计算经验值进度\r\nconst expProgress = computed(() => {\r\n  if (!profile.value) return 0\r\n  \r\n  const currentExp = profile.value.experience_points || 0\r\n  const currentLevelReq = currentLevelExp.value\r\n  const nextLevelReq = nextLevelExp.value\r\n  \r\n  console.log('计算经验进度:', {\r\n    currentExp,\r\n    currentLevelReq,\r\n    nextLevelReq,\r\n    level: profile.value.level\r\n  })\r\n  \r\n  // 如果已经达到或超过下一等级要求，显示100%\r\n  if (currentExp >= nextLevelReq) return 100\r\n  \r\n  // 按照你的要求：经验值 / (经验值 + 到下一等级所需经验值)\r\n  const expNeededForNext = nextLevelReq - currentExp\r\n  const totalExpForProgress = currentExp + expNeededForNext\r\n  \r\n  console.log('进度计算:', {\r\n    expNeededForNext,\r\n    totalExpForProgress\r\n  })\r\n  \r\n  if (totalExpForProgress <= 0) return 0\r\n  \r\n  // 新的进度计算：当前经验值 / (当前经验值 + 到下一等级所需经验值)\r\n  const progress = Math.floor((currentExp / totalExpForProgress) * 100)\r\n  \r\n  console.log('最终进度:', progress)\r\n  \r\n  // 确保进度在0-100之间\r\n  return Math.max(0, Math.min(100, progress))\r\n})\r\n\r\n// 获取等级名称\r\nconst getLevelName = (level: number) => {\r\n  const levelNames = [\r\n    '新手', '初级', '中级', '高级', '资深',\r\n    '专家', '大师', '宗师', '传奇', '史诗',\r\n    '神话', '至尊'\r\n  ]\r\n  \r\n  if (level <= 1) return '新手'\r\n  if (level > levelNames.length) return '至尊'\r\n  return levelNames[level - 1]\r\n}\r\n\r\n// 检查是否可以更换头像\r\nconst canChangeAvatar = computed(() => {\r\n  const level = profile.value?.level || 1\r\n  return level >= 3\r\n})\r\n\r\n// 当前特权列表\r\nconst currentPrivileges = computed(() => {\r\n  const level = profile.value?.level || 1\r\n  const privileges = []\r\n\r\n  // 基础特权\r\n  privileges.push({ id: 'basic', name: '发帖、评论、点赞', icon: '📝' })\r\n\r\n  if (level >= 3) {\r\n    privileges.push({ id: 'avatar', name: '自定义头像', icon: '🖼️' })\r\n  }\r\n\r\n  if (level >= 5) {\r\n    privileges.push({ id: 'signature', name: '个性签名', icon: '✍️' })\r\n  }\r\n\r\n  if (level >= 7) {\r\n    privileges.push({ id: 'color', name: '个性化色彩', icon: '🎨' })\r\n  }\r\n\r\n  if (level >= 10) {\r\n    privileges.push({ id: 'mod', name: '评论置顶权限', icon: '⭐' })\r\n  }\r\n\r\n  return privileges\r\n})\r\n\r\nonMounted(async () => {\r\n  await loadUserData()\r\n})\r\n\r\nconst loadUserData = async () => {\r\n  console.log('开始加载用户数据...')\r\n  loading.value = true\r\n  \r\n  try {\r\n    if (isViewingOtherUser.value) {\r\n      // 加载其他用户的资料\r\n      console.log('加载其他用户资料，ID:', targetUserId.value)\r\n      await loadOtherUserData()\r\n    } else {\r\n      // 加载当前用户的资料\r\n      // 确保用户已登录\r\n      if (!authStore.user) {\r\n        console.warn('用户未登录，无法加载个人资料')\r\n        loading.value = false\r\n        return\r\n      }\r\n      \r\n      console.log('用户已登录，ID:', authStore.user.id)\r\n      \r\n      // 加载用户资料，如果失败则使用默认值\r\n      if (!authStore.profile) {\r\n        console.log('用户资料为空，尝试获取...')\r\n        try {\r\n          console.log('调用fetchProfile...')\r\n          await authStore.fetchProfile()\r\n          console.log('fetchProfile完成')\r\n        } catch (profileError) {\r\n          console.warn('加载用户资料失败，使用默认值:', profileError)\r\n          // 不抛出错误，继续加载用户帖子\r\n        }\r\n      } else {\r\n        console.log('用户资料已存在:', authStore.profile)\r\n      }\r\n      \r\n      // 加载用户帖子\r\n      console.log('开始加载用户帖子...')\r\n      await loadUserPosts()\r\n      console.log('用户帖子加载完成')\r\n    }\r\n  } catch (error) {\r\n    console.error('加载用户数据失败:', error)\r\n  } finally {\r\n    // 确保loading状态总是被设置为false\r\n    console.log('设置loading为false')\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst loadUserPosts = async () => {\r\n  if (!authStore.user) {\r\n    console.warn('用户未登录，无法加载用户帖子')\r\n    userPosts.value = []\r\n    return\r\n  }\r\n  \r\n  try {\r\n    const result = await postStore.fetchUserPosts(authStore.user.id)\r\n    if (result.success) {\r\n      userPosts.value = result.data || []\r\n    } else {\r\n      console.error('加载用户帖子失败:', result.error)\r\n      userPosts.value = []\r\n    }\r\n  } catch (error) {\r\n    console.error('加载用户帖子失败:', error)\r\n    userPosts.value = []\r\n  }\r\n}\r\n\r\nconst handleLike = (postId: string) => {\r\n  console.log('点赞帖子:', postId)\r\n}\r\n\r\nconst handleComment = (postId: string) => {\r\n  console.log('评论帖子:', postId)\r\n}\r\n\r\nconst handleAvatarSelect = async (avatar: any) => {\r\n  try {\r\n    // 先关闭模态框，避免DOM操作冲突\r\n    showAvatarSelector.value = false\r\n    \r\n    // 更新本地存储\r\n    localStorage.setItem('userAvatar', avatar.id)\r\n    \r\n    // 更新本地状态\r\n    if (profile.value) {\r\n      profile.value.avatar_url = avatar.id\r\n    }\r\n    \r\n    // 更新到数据库\r\n    const supabaseUrl = import.meta.env.VITE_SUPABASE_URL\r\n    const supabaseKey = import.meta.env.VITE_SUPABASE_ANON_KEY\r\n    \r\n    if (!supabaseUrl || !supabaseKey || \r\n        supabaseUrl.includes('default.supabase.co') || \r\n        supabaseKey.includes('default')) {\r\n      // 开发模式下只更新本地状态\r\n      console.log('开发模式：头像已更新到本地状态')\r\n      return\r\n    }\r\n    \r\n    // 生产环境下同步到数据库\r\n    const { supabase } = await import('@/services/supabase')\r\n    const { error } = await supabase\r\n      .from('profiles')\r\n      .update({\r\n        avatar_url: avatar.id,\r\n        updated_at: new Date().toISOString()\r\n      })\r\n      .eq('id', authStore.user?.id)\r\n    \r\n    if (error) {\r\n      console.error('更新头像失败:', error)\r\n      // 回滚本地状态\r\n      const previousAvatar = localStorage.getItem('userAvatar')\r\n      if (profile.value) {\r\n        profile.value.avatar_url = previousAvatar || null\r\n      }\r\n    } else {\r\n      console.log('头像更新成功')\r\n    }\r\n  } catch (error) {\r\n    console.error('更新头像失败:', error)\r\n  }\r\n}\r\n\r\n// 加载其他用户数据\r\nconst loadOtherUserData = async () => {\r\n  try {\r\n    const { supabase } = await import('@/services/supabase')\r\n    \r\n    // 获取用户资料\r\n    const { data: profileData, error: profileError } = await supabase\r\n      .from('profiles')\r\n      .select('*')\r\n      .eq('id', targetUserId.value)\r\n      .single()\r\n    \r\n    if (profileError) {\r\n      console.error('获取用户资料失败:', profileError)\r\n      loading.value = false\r\n      return\r\n    }\r\n    \r\n    otherUserProfile.value = profileData\r\n    console.log('其他用户资料加载成功:', profileData)\r\n    \r\n    // 获取用户帖子\r\n    const { data: postsData, error: postsError } = await supabase\r\n      .from('posts')\r\n      .select('*')\r\n      .eq('user_id', targetUserId.value)\r\n      .order('created_at', { ascending: false })\r\n    \r\n    if (postsError) {\r\n      console.error('获取用户帖子失败:', postsError)\r\n    } else {\r\n      userPosts.value = postsData || []\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('加载其他用户数据失败:', error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 工具函数\r\nconst getLevelClass = (level: number) => {\r\n  if (level >= 10) return 'level-10-plus'\r\n  if (level >= 7) return 'level-7-9'\r\n  if (level >= 4) return 'level-4-6'\r\n  return 'level-1-3'\r\n}\r\n\r\nconst formatTime = (timestamp: string) => {\r\n  const date = new Date(timestamp)\r\n  const now = new Date()\r\n  const diff = now.getTime() - date.getTime()\r\n  \r\n  if (diff < 60000) return '刚刚'\r\n  if (diff < 3600000) return `${Math.floor(diff / 60000)}分钟前`\r\n  if (diff < 86400000) return `${Math.floor(diff / 3600000)}小时前`\r\n  if (diff < 604800000) return `${Math.floor(diff / 86400000)}天前`\r\n  \r\n  return date.toLocaleDateString('zh-CN')\r\n}\r\n\r\n// 临时调试函数\r\nconst debugExperience = () => {\r\n  if (profile.value) {\r\n    console.log('Profile data:', profile.value)\r\n    console.log('Experience points:', profile.value.experience_points)\r\n    console.log('Level:', profile.value.level)\r\n    console.log('Current level exp:', currentLevelExp.value)\r\n    console.log('Next level exp:', nextLevelExp.value)\r\n    console.log('Progress:', expProgress.value)\r\n  }\r\n}\r\n\r\n// 测试添加经验值\r\nconst addTestExperience = async () => {\r\n  await authStore.updateExperience(10)\r\n  debugExperience()\r\n}\r\n\r\nconst formatDate = (timestamp: string) => {\r\n  if (!timestamp) return '未知时间'\r\n  return new Date(timestamp).toLocaleDateString('zh-CN')\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.profile {\r\n  min-height: 100vh;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.header {\r\n  background: white;\r\n  border-bottom: 1px solid #f0f0f0;\r\n  padding: 1rem 0;\r\n}\r\n\r\n.container {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  padding: 0 20px;\r\n}\r\n\r\n.header-nav {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.nav {\r\n  display: flex;\r\n  gap: 1rem;\r\n}\r\n\r\n.nav-link {\r\n  color: #666;\r\n  text-decoration: none;\r\n  padding: 0.5rem 1rem;\r\n  border-radius: 4px;\r\n  transition: all 0.2s;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.nav-link:hover {\r\n  background: rgba(24, 144, 255, 0.1);\r\n  color: #1890ff;\r\n}\r\n\r\n.nav-link.active {\r\n  background: #1890ff;\r\n  color: white;\r\n}\r\n\r\n.back-link {\r\n  color: #1890ff;\r\n  text-decoration: none;\r\n  font-size: 0.875rem;\r\n}\r\n\r\n.back-link:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\n.header h1 {\r\n  margin: 0;\r\n  color: #333;\r\n}\r\n\r\n.main {\r\n  padding: 2rem 0;\r\n}\r\n\r\n.loading, .error {\r\n  text-align: center;\r\n  padding: 3rem;\r\n  color: #666;\r\n}\r\n\r\n.profile-card {\r\n  background: white;\r\n  border-radius: 8px;\r\n  padding: 2rem;\r\n  margin-bottom: 2rem;\r\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\r\n}\r\n\r\n.profile-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1.5rem;\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.avatar-container {\r\n  position: relative;\r\n  cursor: pointer;\r\n  transition: transform 0.2s ease;\r\n}\r\n\r\n.avatar-container:hover {\r\n  transform: scale(1.05);\r\n}\r\n\r\n.avatar-container:hover .avatar-edit-hint {\r\n  opacity: 1;\r\n}\r\n\r\n.avatar-edit-hint {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background: rgba(0, 0, 0, 0.7);\r\n  color: white;\r\n  text-align: center;\r\n  padding: 4px;\r\n  font-size: 0.75rem;\r\n  border-radius: 0 0 50% 50%;\r\n  opacity: 0;\r\n  transition: opacity 0.2s ease;\r\n}\r\n\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n  padding: 1rem;\r\n}\r\n\r\n.modal-content {\r\n  max-width: 90vw;\r\n  max-height: 90vh;\r\n  overflow: auto;\r\n}\r\n\r\n.profile-info {\r\n  flex: 1;\r\n}\r\n\r\n.username {\r\n  font-size: 1.5rem;\r\n  font-weight: 600;\r\n  margin: 0 0 0.5rem 0;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1rem;\r\n}\r\n\r\n.level-badge {\r\n  background: #e8f4fd;\r\n  color: #1890ff;\r\n  padding: 0.25rem 0.75rem;\r\n  border-radius: 16px;\r\n  font-size: 0.9rem;\r\n  font-weight: 500;\r\n}\r\n\r\n.level-4-6 { color: #52c41a; }\r\n.level-7-9 { color: #fa8c16; }\r\n.level-10-plus { color: #f5222d; font-weight: 700; }\r\n\r\n.member-since {\r\n  color: #666;\r\n  margin: 0;\r\n}\r\n\r\n.experience-section {\r\n  margin-bottom: 2rem;\r\n  padding: 1rem;\r\n  background: #fafafa;\r\n  border-radius: 8px;\r\n}\r\n\r\n.exp-info {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 0.5rem;\r\n  font-size: 0.9rem;\r\n  color: #666;\r\n}\r\n\r\n.exp-progress {\r\n  position: relative;\r\n  height: 20px;\r\n  background: #e8e8e8;\r\n  border-radius: 10px;\r\n  overflow: hidden;\r\n}\r\n\r\n.exp-bar {\r\n  height: 100%;\r\n  background: linear-gradient(90deg, #52c41a, #1890ff);\r\n  transition: width 0.3s ease;\r\n  border-radius: 10px;\r\n}\r\n\r\n.exp-text {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  font-size: 0.8rem;\r\n  font-weight: 600;\r\n  color: white;\r\n  text-shadow: 0 1px 2px rgba(0,0,0,0.3);\r\n}\r\n\r\n.privileges-section h3 {\r\n  margin: 0 0 1rem 0;\r\n  color: #333;\r\n}\r\n\r\n.privileges-list {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\r\n  gap: 1rem;\r\n}\r\n\r\n.privilege-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.75rem;\r\n  padding: 0.75rem;\r\n  background: #f8f9fa;\r\n  border-radius: 6px;\r\n  border-left: 4px solid #1890ff;\r\n}\r\n\r\n.privilege-icon {\r\n  font-size: 1.2rem;\r\n}\r\n\r\n.privilege-name {\r\n  font-weight: 500;\r\n  color: #333;\r\n}\r\n\r\n.user-posts {\r\n  background: white;\r\n  border-radius: 8px;\r\n  padding: 2rem;\r\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\r\n}\r\n\r\n.user-posts h3 {\r\n  margin: 0 0 1.5rem 0;\r\n  color: #333;\r\n}\r\n\r\n.no-posts {\r\n  text-align: center;\r\n  padding: 3rem;\r\n  color: #666;\r\n}\r\n\r\n.btn-primary {\r\n  background: #1890ff;\r\n  color: white;\r\n  border: none;\r\n  padding: 0.75rem 1.5rem;\r\n  border-radius: 4px;\r\n  text-decoration: none;\r\n  display: inline-block;\r\n  margin-top: 1rem;\r\n}\r\n\r\n.btn-primary:hover {\r\n  background: #40a9ff;\r\n}\r\n\r\n.debug-btn {\r\n  background: #6c757d;\r\n  color: white;\r\n  border: none;\r\n  padding: 4px 8px;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 12px;\r\n  margin-left: 8px;\r\n}\r\n\r\n.debug-btn:hover {\r\n  background: #5a6268;\r\n}\r\n\r\n.test-btn {\r\n  background: #28a745;\r\n  color: white;\r\n  border: none;\r\n  padding: 6px 12px;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 12px;\r\n  margin-top: 8px;\r\n}\r\n\r\n.test-btn:hover {\r\n  background: #218838;\r\n}\r\n\r\n.avatar-container {\r\n  position: relative;\r\n  cursor: pointer;\r\n}\r\n\r\n.avatar-container:not(.can-change) {\r\n  cursor: not-allowed;\r\n}\r\n\r\n.avatar-edit-hint {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background: rgba(0, 0, 0, 0.7);\r\n  color: white;\r\n  text-align: center;\r\n  padding: 4px;\r\n  font-size: 12px;\r\n  border-radius: 0 0 50% 50%;\r\n}\r\n\r\n.avatar-locked {\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background: rgba(255, 0, 0, 0.7);\r\n  color: white;\r\n  text-align: center;\r\n  padding: 4px;\r\n  font-size: 12px;\r\n  border-radius: 0 0 50% 50%;\r\n}\r\n\r\n.exp-debug {\r\n  margin-top: 8px;\r\n  text-align: center;\r\n}\r\n</style>"],"file":"assets/ProfileView-xPtkhRfl.js"}