import{d as y,r as i,a as m,b as s,g as _,e as V,f as n,v as u,t as p,j as v,l as h,p as x,q as k,o as f,s as U,_ as q}from"./index-02sh5J2l.js";import{useAuthStore as P}from"./auth-DsvB8qh0.js";const R={class:"register-container"},S={class:"register-form"},C={class:"form-group"},N={class:"form-group"},T={class:"form-group"},j={class:"form-group"},z=["disabled"],B={key:0,class:"error-message"},M={class:"form-footer"},D=y({__name:"RegisterView",setup(E){const d=U(),c=P(),o=i({username:"",email:"",password:"",confirmPassword:""}),a=i(!1),r=i(""),g=()=>o.value.username.length<3?(r.value="用户名至少需要3个字符",!1):o.value.password.length<6?(r.value="密码至少需要6个字符",!1):o.value.password!==o.value.confirmPassword?(r.value="两次输入的密码不一致",!1):(r.value="",!0),w=async()=>{if(console.log("🔄 注册按钮被点击"),!g()){console.log("❌ 表单验证失败");return}a.value=!0,r.value="";try{console.log("📧 注册信息:",{username:o.value.username,email:o.value.email});const t="https://bkintupjzbcjiqvzricz.supabase.co";if(!t||t.includes("default.supabase.co")){console.log("🔧 开发模式：模拟注册流程"),setTimeout(()=>{console.log("✅ 开发模式注册成功"),a.value=!1,alert("注册成功！请配置真实的Supabase环境变量以使用完整功能。"),d.push("/login")},1e3);return}console.log("🔐 尝试真实Supabase注册...");const e=await c.signUp(o.value.email,o.value.password,o.value.username);if(!e.success){console.error("❌ 注册失败:",e.error),e.error.includes("Email not confirmed")?r.value="✅ 注册成功！请检查您的邮箱并点击确认链接完成注册。":e.error.includes("row-level security")?r.value="✅ 注册成功！但用户资料创建受限。请联系管理员修复数据库权限。":e.error.includes("User already registered")?r.value="❌ 该邮箱已被注册，请使用其他邮箱或尝试登录。":r.value=e.error||"注册失败，请稍后重试";return}console.log("✅ 注册成功:",e.message),e.message&&e.message.includes("邮箱验证")?r.value="✅ 注册成功！请检查您的邮箱并点击确认链接完成注册。":r.value="✅ 注册成功！正在跳转到登录页面...",setTimeout(()=>{d.push("/login")},3e3)}catch(t){console.error("❌ 注册异常:",t),r.value="注册失败，请稍后重试"}finally{a.value=!1}};return(t,e)=>{const b=k("RouterLink");return f(),m("div",R,[s("div",S,[e[10]||(e[10]=s("h2",null,"注册连接者论坛",-1)),s("form",{onSubmit:V(w,["prevent"]),class:"form"},[s("div",C,[e[4]||(e[4]=s("label",{for:"username"},"用户名",-1)),n(s("input",{id:"username","onUpdate:modelValue":e[0]||(e[0]=l=>o.value.username=l),type:"text",placeholder:"请输入用户名",required:"",minlength:"3",maxlength:"20"},null,512),[[u,o.value.username]])]),s("div",N,[e[5]||(e[5]=s("label",{for:"email"},"邮箱",-1)),n(s("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=l=>o.value.email=l),type:"email",placeholder:"请输入邮箱",required:""},null,512),[[u,o.value.email]])]),s("div",T,[e[6]||(e[6]=s("label",{for:"password"},"密码",-1)),n(s("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=l=>o.value.password=l),type:"password",placeholder:"请输入密码",required:"",minlength:"6"},null,512),[[u,o.value.password]])]),s("div",j,[e[7]||(e[7]=s("label",{for:"confirmPassword"},"确认密码",-1)),n(s("input",{id:"confirmPassword","onUpdate:modelValue":e[3]||(e[3]=l=>o.value.confirmPassword=l),type:"password",placeholder:"请再次输入密码",required:""},null,512),[[u,o.value.confirmPassword]])]),s("button",{type:"submit",disabled:a.value,class:"register-btn"},p(a.value?"注册中...":"注册"),9,z)],32),r.value?(f(),m("div",B,p(r.value),1)):_("",!0),s("div",M,[s("p",null,[e[9]||(e[9]=v("已有账号？ ",-1)),h(b,{to:"/login",class:"link"},{default:x(()=>[...e[8]||(e[8]=[v("立即登录",-1)])]),_:1})])])])])}}}),F=q(D,[["__scopeId","data-v-856ed134"]]);export{F as default};
//# sourceMappingURL=RegisterView-DUAm_2p-.js.map
