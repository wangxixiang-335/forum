import{d as y,r as i,c as m,a as s,b as _,e as V,j as n,v as u,t as p,f as v,k as h,q as x,s as k,h as f,x as U,_ as q}from"./index-DvT1nwGZ.js";import{useAuthStore as P}from"./auth-hIVPxf3j.js";const R={class:"register-container"},S={class:"register-form"},C={class:"form-group"},N={class:"form-group"},T={class:"form-group"},j={class:"form-group"},z=["disabled"],B={key:0,class:"error-message"},M={class:"form-footer"},D=y({__name:"RegisterView",setup(E){const d=U(),c=P(),o=i({username:"",email:"",password:"",confirmPassword:""}),a=i(!1),r=i(""),g=()=>o.value.username.length<3?(r.value="ç”¨æˆ·åè‡³å°‘éœ€è¦3ä¸ªå­—ç¬¦",!1):o.value.password.length<6?(r.value="å¯†ç è‡³å°‘éœ€è¦6ä¸ªå­—ç¬¦",!1):o.value.password!==o.value.confirmPassword?(r.value="ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´",!1):(r.value="",!0),w=async()=>{if(console.log("ğŸ”„ æ³¨å†ŒæŒ‰é’®è¢«ç‚¹å‡»"),!g()){console.log("âŒ è¡¨å•éªŒè¯å¤±è´¥");return}a.value=!0,r.value="";try{console.log("ğŸ“§ æ³¨å†Œä¿¡æ¯:",{username:o.value.username,email:o.value.email});const t="https://bkintupjzbcjiqvzricz.supabase.co";if(!t||t.includes("default.supabase.co")){console.log("ğŸ”§ å¼€å‘æ¨¡å¼ï¼šæ¨¡æ‹Ÿæ³¨å†Œæµç¨‹"),setTimeout(()=>{console.log("âœ… å¼€å‘æ¨¡å¼æ³¨å†ŒæˆåŠŸ"),a.value=!1,alert("æ³¨å†ŒæˆåŠŸï¼è¯·é…ç½®çœŸå®çš„Supabaseç¯å¢ƒå˜é‡ä»¥ä½¿ç”¨å®Œæ•´åŠŸèƒ½ã€‚"),d.push("/login")},1e3);return}console.log("ğŸ” å°è¯•çœŸå®Supabaseæ³¨å†Œ...");const e=await c.signUp(o.value.email,o.value.password,o.value.username);if(!e.success){console.error("âŒ æ³¨å†Œå¤±è´¥:",e.error),e.error.includes("Email not confirmed")?r.value="âœ… æ³¨å†ŒæˆåŠŸï¼è¯·æ£€æŸ¥æ‚¨çš„é‚®ç®±å¹¶ç‚¹å‡»ç¡®è®¤é“¾æ¥å®Œæˆæ³¨å†Œã€‚":e.error.includes("row-level security")?r.value="âœ… æ³¨å†ŒæˆåŠŸï¼ä½†ç”¨æˆ·èµ„æ–™åˆ›å»ºå—é™ã€‚è¯·è”ç³»ç®¡ç†å‘˜ä¿®å¤æ•°æ®åº“æƒé™ã€‚":e.error.includes("User already registered")?r.value="âŒ è¯¥é‚®ç®±å·²è¢«æ³¨å†Œï¼Œè¯·ä½¿ç”¨å…¶ä»–é‚®ç®±æˆ–å°è¯•ç™»å½•ã€‚":r.value=e.error||"æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•";return}console.log("âœ… æ³¨å†ŒæˆåŠŸ:",e.message),e.message&&e.message.includes("é‚®ç®±éªŒè¯")?r.value="âœ… æ³¨å†ŒæˆåŠŸï¼è¯·æ£€æŸ¥æ‚¨çš„é‚®ç®±å¹¶ç‚¹å‡»ç¡®è®¤é“¾æ¥å®Œæˆæ³¨å†Œã€‚":r.value="âœ… æ³¨å†ŒæˆåŠŸï¼æ­£åœ¨è·³è½¬åˆ°ç™»å½•é¡µé¢...",setTimeout(()=>{d.push("/login")},3e3)}catch(t){console.error("âŒ æ³¨å†Œå¼‚å¸¸:",t),r.value="æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"}finally{a.value=!1}};return(t,e)=>{const b=k("RouterLink");return f(),m("div",R,[s("div",S,[e[10]||(e[10]=s("h2",null,"æ³¨å†Œè¿æ¥è€…è®ºå›",-1)),s("form",{onSubmit:V(w,["prevent"]),class:"form"},[s("div",C,[e[4]||(e[4]=s("label",{for:"username"},"ç”¨æˆ·å",-1)),n(s("input",{id:"username","onUpdate:modelValue":e[0]||(e[0]=l=>o.value.username=l),type:"text",placeholder:"è¯·è¾“å…¥ç”¨æˆ·å",required:"",minlength:"3",maxlength:"20"},null,512),[[u,o.value.username]])]),s("div",N,[e[5]||(e[5]=s("label",{for:"email"},"é‚®ç®±",-1)),n(s("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=l=>o.value.email=l),type:"email",placeholder:"è¯·è¾“å…¥é‚®ç®±",required:""},null,512),[[u,o.value.email]])]),s("div",T,[e[6]||(e[6]=s("label",{for:"password"},"å¯†ç ",-1)),n(s("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=l=>o.value.password=l),type:"password",placeholder:"è¯·è¾“å…¥å¯†ç ",required:"",minlength:"6"},null,512),[[u,o.value.password]])]),s("div",j,[e[7]||(e[7]=s("label",{for:"confirmPassword"},"ç¡®è®¤å¯†ç ",-1)),n(s("input",{id:"confirmPassword","onUpdate:modelValue":e[3]||(e[3]=l=>o.value.confirmPassword=l),type:"password",placeholder:"è¯·å†æ¬¡è¾“å…¥å¯†ç ",required:""},null,512),[[u,o.value.confirmPassword]])]),s("button",{type:"submit",disabled:a.value,class:"register-btn"},p(a.value?"æ³¨å†Œä¸­...":"æ³¨å†Œ"),9,z)],32),r.value?(f(),m("div",B,p(r.value),1)):_("",!0),s("div",M,[s("p",null,[e[9]||(e[9]=v("å·²æœ‰è´¦å·ï¼Ÿ ",-1)),h(b,{to:"/login",class:"link"},{default:x(()=>[...e[8]||(e[8]=[v("ç«‹å³ç™»å½•",-1)])]),_:1})])])])])}}}),F=q(D,[["__scopeId","data-v-856ed134"]]);export{F as default};
//# sourceMappingURL=RegisterView-ffHvHDCK.js.map
